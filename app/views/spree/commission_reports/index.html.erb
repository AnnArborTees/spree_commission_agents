<div class="container">
  <h1 class="header">Commission Information</h1>
  <h2>Commission Balance</h2>
  <dl>
    <dt>
      Current Balance:
    </dt>
    <dd>
      <%= number_to_currency @user.commission_balance_as_of %>
    </dd>
  </dl>
  <h2>Commission Payments</h2>
  <% if @user.commission_payments.empty? %>
      <p>There are currently no commission payments on record for your account</p>
      <% else %>
      <table class="table table-condensed" id="listing_users" data-hook>
        <thead>
        <tr>
          <th>Date</th>
          <th>Amount</th>
          <th>Method</th>
          <th>TX-ID</th>
          <th>Bring Current At</th>
        </tr>
        </thead>
        <tbody>
        <% @user.commission_payments.each do |cp|%>
            <tr id="<%= spree_dom_id cp %>" data-hook="admin_user_commission_payments_index_rows" class="<%= cycle('odd', 'even')%>">
              <td><%= cp.created_at.strftime('%F') %></td>
              <td><%= number_to_currency cp.amount %></td>
              <td><%= cp.payment_method %></td>
              <td><%= cp.transaction_id %></td>
              <td><%= cp.bring_current_at %></td>
            </tr>
        <% end %>
        </tbody>
      </table>
  <% end %>


  <h2 class="header">Commission Reports</h1>
  <h3>Recent Months</h3>
  <ul>
    <li><%= link_to 'This Month', "/commission/#{Time.now.strftime('%Y-%m-01')}...#{Time.now.utc.end_of_month.strftime('%Y-%m-%d')}" %></li>
    <li><%= link_to 'Last Month', "/commission/#{(Time.now - 1.month).strftime('%Y-%m-01')}...#{(Time.now - 1.month).utc.end_of_month.strftime('%Y-%m-%d')}" %></li>
  </ul>

  <h3>Custom Timeframe</h3>

  <%= form_tag commission_reports_path, method: :post, id: 'sales_report_form' do %>
    <!-- the following data-date-format are for use with datetimepicker-rails -->

      <p class="field" id="commission_report_start_date">
      <%= label_tag "Start Date" %><span class="required">*</span>
      <%= text_field_tag :start_time, nil, 'data-date-format' => 'YYYY-MM-DD', placeholder: 'Start Time (Format YYYY-MM-DD)', class: 'form-control required' %>
    </p>

      <p class="field" id="commission_report_end_date">
      <%= label_tag "End Date" %><span class="required">*</span>
      <%= text_field_tag :end_time, nil, 'data-date-format' => 'YYYY-MM-DD', placeholder: 'End Time (Format YYYY-MM-DD)', class: 'form-control required'  %>
    </p>
      <%= button_tag 'Generate Report', class: 'btn btn-default' %>
  <% end %>

</div>